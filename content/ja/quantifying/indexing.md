---
title: "インデックス構築"
linkTitle: "インデックス構築"
type: docs
weight: 3
description: >-
     FSTAQデータのインデックス構築（特に salmon）についてのページ---
## 1. k-mer分割の処理

トランスクリプト配列は、スライディングウィンドウ法を用いてk-merに分割されます。例えば、トランスクリプト "ACGTGCA" をk=3で分割すると、以下のようなk-merが生成されます：

```
ACG, CGT, GTG, TGC, GCA

```

## 2. インデックス構築のプロセス

### k-merインデックス作成

各k-merについて、以下の重要な情報が記録されます：

- トランスクリプトID：k-merが由来するトランスクリプトの識別子
- 開始位置：当該k-merのトランスクリプト内での位置情報

これらの情報は、ハッシュテーブルやブルームフィルタなどの効率的なデータ構造に格納され、高速な検索を可能にします。

### k-mer 長のトレードオフ
![](https://lh7-rt.googleusercontent.com/slidesz/AGV_vUd7qeoW2ALQ-XQfLgtXf1HvfYtW39Ru8lq2fEK2QYl6fW1hQk4BjP3H2IXoLSl2UNJ9qfZSLOpnr-fqef4KRhIGWc9luC2tvd-lEQl_3ipYCgsKVyuk_pJPer33Ju30EgD1cDDVsA=s2048?key=l7MYQrRs2jcfgC6C66ku8rLU)

## 3. k-merインデックスとFMインデックスの統合アプローチ

### 候補探索フェーズ（k-merインデックス）

k-merインデックスを使用して、最初の粗い候補探索を実行します。このフェーズでは：

- リード内のk-merとリファレンスのk-merインデックスを比較
- マッピング候補となるトランスクリプトを効率的に特定

### 精密マッピングフェーズ（FMインデックス）

候補として特定されたトランスクリプトに対して、より詳細なマッピングを実行します：

- FMインデックスを用いたリード全体のパターン検索
- 正確なマッピング位置の決定

この2段階アプローチにより、Salmonは高いメモリ効率を維持しながら、精度の高い高速マッピングを実現しています。

### 統合アプローチを取る理由

Salmonが最初にk-merインデックスを利用する理由は、計算効率を大幅に向上させるためです。

#### **k-merインデックスの計算コストはリードの一部に限定される**

- リード全体ではなく、k-merという固定長（例えば31塩基）の部分配列に注目することで、検索空間を大幅に縮小できます。
- Salmonでは、リードのすべてのk-merを調べるのではなく、一部のk-merだけを検索に使用します。

### **候補トランスクリプトの絞り込み**

- k-merインデックスを利用して、リードが一致する可能性のあるトランスクリプト（候補集合）を迅速に特定します。
- この絞り込みを行うことで、FMインデックスの精密検索の対象が限られ、全体の計算コストを削減できます。
